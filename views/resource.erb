<table id="main">
  <tr><td id="page_header" colspan=3>
      RESOURCE
    </td>
  </tr>
  <tr>
    <td id="remove_add" class="borderbottom">
      <div class="x sprites"><a href="#" class="x sprites"></a></div><div class=link">&nbsp;<a href="#" onclick="verify_remove();">Remove</a>&nbsp;&nbsp;&nbsp;&nbsp;</div>
      <div class="plus sprites"></div><div class="link">&nbsp;<a href="#" onclick="$('#add_resource').dialog({title: 'Add Resource', modal:true, width: 'auto'});">Add</a>&nbsp;&nbsp;&nbsp;&nbsp;</div>
      <div class="plus sprites"></div><div class="link">&nbsp;<a href="#" onclick="alert('Not Yet Implemented');">Create Group</a></div>
    </td>
    <td class="borderbottom">&nbsp;</td>
    <td id="tab_name" width="115">
      <div style="float: left">&nbsp;Edit Resource&nbsp;</div><div class="check sprites"></div>
    </td>
  </tr>
  <tr>
    <td id="node_list">
      <table cellpadding=0 cellspacing=0 style="float:left;">
	<tr>
	  <th></th><th></th><th>NAME</th><th>TYPE</th><th></th>
	</tr>
	<% @resources.each  do |r| %>
	  <% if r != @cur_resource %>
	    <tr onmouseover="$(this).css('background-color', 'e4f5fd');$(this).find('td').last().css('display','');" onmouseout="$(this).css('background-color','ffffff');$(this).find('td').last().css('display','none');" onclick="window.location='/resources/<%=r.id%>'">
	    <% else %>
	      <tr style="background-color: #e4f5fd">
	      <% end %>
	      <td class="node_list_check">
		<input class="node_list_check" type="checkbox" res_id="<%=r.id%>">
	      </td>
	      <td class="node_list_sprite">
		<div class="check sprites"></div>
	      </td>
	      <td nowrap class="resource_name" <%= 'style="color:red;" ' if r.failed || !r.active%>>
		<%= r.id %>
	      </td>
	      <td class="resource_type">
		<%= r.agentname.sub(/.*:/,'') %>
	      </td>
	      <% if r != @cur_resource %>
		<td style="display:none">
		<% else %>
		  <td>
		  <% end %>
		  <div class="arrow sprites"></div>
		</td>
	      </tr>
	    <% end %>
	  </table>
	</td>
	<td id="node_info" colspan=2>
	  <div id="test">
	    <div id="node_info_header">
	      <div id="node_info_header_title">Edit Resource</div>
	      <div id="node_info_header_title_name">&nbsp;<%=@cur_resource.id%></div>
	      <div class="link" style="float: right" onclick="$('#node_info').css('height',$('#node_info').height());$('#test').hide('slide');">Close</div>
	      <div class="x sprites" style="float: right"></div>
	    </div>

	    <div id="node_sub_info">
	      <table>
		<tr>
		  <td><input style="margin-right: 50px;" type="text" value="<%=@cur_resource.id%>" size="35" class="text_field"></td>
		  <td><div style="margin-right: 8px;" class="check sprites"></div></td>
		  <td>
		    <% if @cur_resource.failed %>
		      <div class="status-offline">Failed</div>
		    <% elsif not @cur_resource.active %>
		      <div class="status-offline">Inactive</div>
		    <% else %>
		      <div class="status">Running</div>
		    <% end %>
		  </td>
		</tr>
	      </table>
	    </div>

	    <div id="node_options_buttons">
	      <div class="xdark sprites" style="float: left"></div>
	      <div class="link">Delete</div>
	      <div class="cancel sprites" style="float: left"></div>
	      <div class="link">Stop</div>
	      <div class="restart sprites" style="float: left"></div>
	      <div class="link">Restart</div>
	      <div class="move sprites" style="float: left"></div>
	      <div class="link">Move</div>
	      <div class="history sprites" style="float: left"></div>
	      <div class="link">History</div>
	    </div>

	    <div id="node_details">
	      <table><tr>
		  <td nowrap><div class="bold">Current Location:</div></td>
		  <td><div class="reg"><%=@cur_resource.location%></div></td>
		</tr>
	      </table>
	    </div>

	    <table id="resource_selector" style="clear:left;float:left;margin-top:25px;">
	      <tr>
		<td class="bold">Class</td>
		<td>
		  <select disabled>
		    <option value="OCF">OCF</option>
		  </select>
		</td>
		<td style="padding-left:10px;" class="bold">Provider</td>
		<td>
		  <select disabled>
		    <option value="heartbeat">heartbeat</option>
		  </select>
		</td>
	      </tr>
	      <tr>
		<td class="bold">Type</td>
		<td>
		  <select  disabled id="ra_type" onchange="$('#cur_resource_agent').load('/resources/metadata/' + this.value);">
		    <% @resource_agents.each { |name, ra| %>
		      <option <%= ra.name == @cur_resource.agentname ? "selected" : ""%> width=250px value="<%=ra.type%>"><%=ra.type%></option>
		    <% } %>
		  </select>
		</td>
	      </tr>
	    </table>

	    <% @resource = @resource_agents[@cur_resource.agentname] %>
	    <% @existing_resource = true %>
	    <%= erb :resourceagentform %>
	  </td>
	</tr>
      </div>
    </table>
    <div id="add_resource" style="display: none;">
      <table id="resource_selector" style="clear:left;float:left;margin-top:25px;">
	<tr>
	  <td class="bold">Class</td>
	  <td>
	    <select>
	      <option value="OCF">OCF</option>
	    </select>
	  </td>
	  <td style="padding-left:10px;" class="bold">Provider</td>
	  <td>
	    <select>
	      <option value="heartbeat">heartbeat</option>
	    </select>
	  </td>
	</tr>
	<tr>
	  <td class="bold">Type</td>
	  <td>
	    <select id="add_ra_type" onchange="$('#new_resource_agent').load('/resources/metadata/' + this.value + '/new');">
	      <% @resource_agents.each { |name, ra| %>
		<option <%= ra.name == @cur_resource.agentname ? "selected" : ""%> width=250px value="<%=ra.type%>"><%=ra.type%></option>
	      <% } %>
	    </select>
	  </td>
	</tr>
      </table>
      <div id="new_resource_agent">
      </div>
    </div>
    <div id="verify_remove" style="display: none;">
      <p style="font-size:12px;">Are you sure you want to remove the following resource(s)?</p>
      <span id="resource_to_remove"></span>
    </div>

